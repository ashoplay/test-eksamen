<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mine Reinsdyr - Kukkik Ano</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <header class="header">
    <div class="container">
      <nav class="navbar">
        <div class="logo">Kukkik Ano</div>
        <ul class="nav-links" id="authLinks" style="display: none;">
          <li><a href="/">Hjem</a></li>
          <li><a href="/login">Logg inn</a></li>
          <li><a href="/register">Registrer</a></li>
          <li><a href="/eiere">Eiere</a></li>
          <li><a href="/faq">FAQ</a></li>
          <li><a href="/kart">Kart</a></li>
          <li><a href="/databaseinfo">Database info</a></li>
        </ul>
        <ul class="nav-links" id="userLinks">
          <li><a href="/">Hjem</a></li>
          <li><a href="/reinsdyr">Mine reinsdyr</a></li>
          <li><a href="/flokk">Mine flokker</a></li>
          <li><a href="/eiere">Eiere</a></li>
          <li><a href="/transactions">Transaksjoner</a></li>
          <li><a href="/faq">FAQ</a></li>
          <li><a href="/kart">Kart</a></li>
          <li><a href="/nettverkskart">Nettverkskart</a></li>
          <li><a href="/databaseinfo">Database info</a></li>
          <li><span id="username"></span></li>
          <li><a href="#" id="logoutBtn">Logg ut</a></li>
        </ul>
      </nav>
    </div>
  </header>
  
  <main class="main">
    <div class="container">
      <h1 class="page-title">Mine Reinsdyr</h1>
      
      <div class="card">
        <h2 class="card-title collapsible" onclick="toggleCollapsible(this)">
          Registrer nytt reinsdyr
          <span class="toggle-icon">+</span>
        </h2>
        
        <div style="display: none;">
          <div id="message"></div>
          
          <form id="reinsdyrForm">
            <div class="form-group">
              <label for="serienummer" class="form-label">Serienummer</label>
              <input type="text" id="serienummer" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label for="navn" class="form-label">Navn</label>
              <input type="text" id="navn" class="form-input" required>
            </div>
            
            <div class="form-group">
              <label for="flokkId" class="form-label">Flokk</label>
              <select id="flokkId" class="form-select" required>
                <option value="">Laster flokker...</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="fodselsdato" class="form-label">FÃ¸dselsdato</label>
              <input type="date" id="fodselsdato" class="form-input" required>
            </div>
            
            <div class="form-group">
              <button type="submit" class="btn btn-primary">Registrer</button>
            </div>
          </form>
        </div>
      </div>
      
      <h2 class="section-title">Mine registrerte reinsdyr</h2>
      <div id="reinsdyrList">
        <p>Laster reinsdyr...</p>
      </div>
      
      <!-- Debug information -->
      <div id="debugInfo" style="margin-top: 20px; padding: 10px; background-color: #f8f9fa; border: 1px solid #ddd; border-radius: 5px; display: none;">
        <h3>Debug Information</h3>
        <div id="debugContent"></div>
      </div>
    </div>
  </main>
  
  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 Kukkik Ano - Reinsdyrdatabase</p>
    </div>
  </footer>
  
  <script src="/js/scripts.js"></script>
  <script src="/js/debug.js"></script>
  <script>
    // Additional debug for this page
    document.addEventListener('DOMContentLoaded', function() {
      const reinsdyrList = document.getElementById('reinsdyrList');
      const debugContent = document.getElementById('debugContent');
      
      if (reinsdyrList && debugContent) {
        // Check for token
        const token = localStorage.getItem('token');
        if (!token) {
          debugContent.innerHTML += '<p>No token found in localStorage</p>';
        } else {
          debugContent.innerHTML += '<p>Token found in localStorage</p>';
        }
        
        // Manual API call to verify data
        fetch('/api/reinsdyr/my', {
          headers: {
            'Authorization': `Bearer ${token}`
          }
        })
        .then(response => {
          console.log('Response status:', response.status);
          return response.json();
        })
        .then(data => {
          debugContent.innerHTML += `<p>Manual API call result:</p>
            <pre>${JSON.stringify(data, null, 2)}</pre>`;
        })
        .catch(error => {
          debugContent.innerHTML += `<p>Error in manual API call:</p>
            <pre>${error.message}</pre>`;
        });
      }
    });
  </script>
</body>
</html>